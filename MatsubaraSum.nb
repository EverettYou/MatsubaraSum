(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     11777,        375]
NotebookOptionsPosition[      8672,        294]
NotebookOutlinePosition[      9028,        310]
CellTagsIndexPosition[      8985,        307]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["Load the package by:", "Text",ExpressionUUID->"d2f888d9-6cf4-4036-a2fd-447fb287ab99"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "MatsubaraSum`"}]}], "Input",ExpressionUUID->"dfd1ca73-7d13-\
49bb-834b-f4f08e93ba40"],

Cell[TextData[{
 "The package defines the function ",
 StyleBox["MatsubaraSum", "Input"],
 " and several notations about distribution functions."
}], "Text",ExpressionUUID->"7a16be87-d0a8-4438-9dd4-eb64351a9a6d"],

Cell[TextData[{
 "Generic summation ",
 StyleBox["MatsubaraSum[", "Input"],
 StyleBox["f(z), z", "Program"],
 StyleBox["]", "Input"],
 " evaluates the summation"
}], "Item",ExpressionUUID->"341c3fe3-786a-45e1-9107-405f3a788f5e"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "\[Beta]"], 
  RowBox[{
   UnderscriptBox["\[Sum]", 
    RowBox[{"\[ImaginaryI]", " ", 
     SubscriptBox["\[Omega]", "n"]}]], 
   RowBox[{"f", 
    RowBox[{"(", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Omega]", "n"]}], ")"}]}]}]}]], "DisplayFormula",Expressi\
onUUID->"1df81cff-2087-4b36-84f0-bc55f75bbe58"],

Cell[TextData[{
 "The result is expressed in terms of the distribution function ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["n", "\[Eta]"], "(", "x", ")"}], TraditionalForm]],
  ExpressionUUID->"1e8be978-a854-445f-bde9-3b685a3d2c8a"],
 " and its derivatives."
}], "ItemParagraph",ExpressionUUID->"14a71c88-d104-41d8-afb9-a1cf5e1749a8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatsubaraSum", "[", 
  RowBox[{
   RowBox[{"1", "/", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"z", "-", "\[Epsilon]"}], ")"}], "^", "2"}]}], ",", "z"}], 
  "]"}]], "Input",ExpressionUUID->"8d6efee4-38d8-4b0f-8617-7302ed8691b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "\[Eta]"}], " ", 
  RowBox[{
   SubsuperscriptBox["n", "\[Eta]", "\[Prime]"], "[", "\[Epsilon]", 
   "]"}]}]], "Output",ExpressionUUID->"3a18ed84-d833-4b90-8592-238b617cde05"]
}, Open  ]],

Cell[TextData[{
 "Specifies the inverse temperature to be ",
 Cell[BoxData[
  FormBox["\[Beta]", TraditionalForm]],ExpressionUUID->
  "15d4ae76-51a7-4f36-aa11-93d32e498522"],
 ". The explicit form of the distribution function will be substituted."
}], "Item",ExpressionUUID->"84a7ae8d-9b25-4c72-8e49-a1b2d734271e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatsubaraSum", "[", 
  RowBox[{
   RowBox[{"1", "/", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"z", "-", "\[Epsilon]"}], ")"}], "^", "2"}]}], ",", "z", ",", 
   "\[Beta]"}], "]"}]], "Input",ExpressionUUID->"2003a662-66b9-4130-bf2b-\
c77df6deb1d3"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[Beta]", " ", "\[Epsilon]"}]], " ", "\[Beta]", " ", "\[Eta]"}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[Beta]", " ", "\[Epsilon]"}]], " ", "\[Eta]"}]}], ")"}], 
   "2"]]], "Output",ExpressionUUID->"32479f24-dfbb-4065-936e-b6aafc06ed9a"]
}, Open  ]],

Cell[TextData[{
 "Specifies Matsubara weighting function to be either ",
 StyleBox["Fermionic", "Input"],
 " or ",
 StyleBox["Bosonic", "Input"],
 "."
}], "Item",ExpressionUUID->"920bd736-2ded-4c4c-9a43-adfe5d82eb38"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatsubaraSum", "[", 
  RowBox[{
   RowBox[{"1", "/", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"z", "-", "\[Epsilon]"}], ")"}], "^", "2"}]}], ",", "z", ",", 
   RowBox[{"WeightingFunction", "\[Rule]", "Fermionic"}]}], "]"}]], "Input",Ex\
pressionUUID->"63ff7753-665c-4382-ac23-0fc0f3de761f"],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["n", "F", "\[Prime]"], "[", "\[Epsilon]", "]"}]], "Output",\
ExpressionUUID->"3a140f09-3b1f-4e2e-b3f0-95079e73b46c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatsubaraSum", "[", 
  RowBox[{
   RowBox[{"1", "/", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"z", "-", "\[Epsilon]"}], ")"}], "^", "2"}]}], ",", "z", ",", 
   "\[Beta]", ",", 
   RowBox[{"WeightingFunction", "\[Rule]", "Fermionic"}]}], "]"}]], "Input",Ex\
pressionUUID->"4b7e9ab4-9720-44bb-a1f5-10324461303b"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[Beta]", " ", "\[Epsilon]"}]], " ", "\[Beta]"}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[Beta]", " ", "\[Epsilon]"}]]}], ")"}], "2"]]}]], "Output",Ex\
pressionUUID->"156ed51a-1853-401e-8e39-fff495be5c25"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatsubaraSum", "[", 
  RowBox[{
   RowBox[{"1", "/", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"z", "-", "\[Epsilon]"}], ")"}], "^", "2"}]}], ",", "z", ",", 
   "\[Beta]", ",", 
   RowBox[{"WeightingFunction", "\[Rule]", "Bosonic"}]}], "]"}]], "Input",Expr\
essionUUID->"96564734-57d1-4e2d-a634-cbcc7fb7ec54"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[Beta]", " ", "\[Epsilon]"}]], " ", "\[Beta]"}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[Beta]", " ", "\[Epsilon]"}]]}], ")"}], "2"]]], "Output",Expre\
ssionUUID->"11f040fa-e183-4a90-9bf4-43a1d011c557"]
}, Open  ]],

Cell[TextData[{
 "One can specify a variable to be bosonic/fermionic frequency by adding the \
variable to the list of ",
 StyleBox["BosonicFrequencies", "Input"],
 " or ",
 StyleBox["FermionicFrequencies", "Input"],
 ". By default, ",
 Cell[BoxData[
  FormBox["i\[Nu]", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "02710c69-57b3-42ff-be5c-360c9f5f6ae3"],
 " is bosonic and ",
 Cell[BoxData[
  FormBox["i\[Omega]", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "abd1a266-a647-4e34-ab79-f747cad28f48"],
 " is fermionic."
}], "Text",ExpressionUUID->"0750491d-f143-401a-b001-0de3c25d08ac"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"BosonicFrequencies", ",", "FermionicFrequencies"}], "}"}]], "Input",\
ExpressionUUID->"95dae21b-4f3a-401c-9acc-706537bae14d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "i\[Nu]", "}"}], ",", 
   RowBox[{"{", "i\[Omega]", "}"}]}], "}"}]], "Output",ExpressionUUID->\
"88801a6f-d855-4e81-8934-283befe0e698"]
}, Open  ]],

Cell["\<\
Simplification of distribution functions are carried out automatically. Note \
the difference in the following two results.\
\>", "Text",ExpressionUUID->"474ac446-dad6-4763-aa90-f96024edde57"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatsubaraSum", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"z", "-", "a"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"z", "+", "i\[Nu]", "-", "b"}], ")"}]}], ",", "z", ",", 
   RowBox[{"WeightingFunction", "\[Rule]", "Fermionic"}]}], "]"}]], "Input",Ex\
pressionUUID->"4adc409f-fe4e-4ca7-bba7-3f5f8417ed9b"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SubscriptBox["n", "F"], "[", "a", "]"}], 
   RowBox[{"a", "-", "b", "+", "i\[Nu]"}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["n", "F"], "[", "b", "]"}], 
   RowBox[{"a", "-", "b", "+", "i\[Nu]"}]]}]], "Output",ExpressionUUID->\
"87831d2c-98f2-4774-a4eb-6de87c61db64"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatsubaraSum", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"z", "-", "a"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"z", "+", "i\[Omega]", "-", "b"}], ")"}]}], ",", "z", ",", 
   RowBox[{"WeightingFunction", "\[Rule]", "Fermionic"}]}], "]"}]], "Input",Ex\
pressionUUID->"bd37416b-22c6-4037-9533-3942b39cfde5"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SubscriptBox["n", "F"], "[", "a", "]"}], 
   RowBox[{"a", "-", "b", "+", "i\[Omega]"}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["n", "B"], "[", "b", "]"}], 
   RowBox[{"a", "-", "b", "+", "i\[Omega]"}]]}]], "Output",ExpressionUUID->\
"700125d5-4583-4f5c-a3ae-66eb3cc91eef"]
}, Open  ]]
},
WindowSize->{607, 545},
WindowMargins->{{206, Automatic}, {Automatic, 70}},
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 18, \
2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 91, 0, 30, "Text", "ExpressionUUID" -> \
"d2f888d9-6cf4-4036-a2fd-447fb287ab99"],
Cell[639, 22, 243, 6, 54, "Input", "ExpressionUUID" -> \
"dfd1ca73-7d13-49bb-834b-f4f08e93ba40"],
Cell[885, 30, 212, 4, 50, "Text", "ExpressionUUID" -> \
"7a16be87-d0a8-4438-9dd4-eb64351a9a6d"],
Cell[1100, 36, 228, 6, 31, "Item", "ExpressionUUID" -> \
"341c3fe3-786a-45e1-9107-405f3a788f5e"],
Cell[1331, 44, 369, 11, 52, "DisplayFormula", "ExpressionUUID" -> \
"1df81cff-2087-4b36-84f0-bc55f75bbe58"],
Cell[1703, 57, 349, 8, 42, "ItemParagraph", "ExpressionUUID" -> \
"14a71c88-d104-41d8-afb9-a1cf5e1749a8"],
Cell[CellGroupData[{
Cell[2077, 69, 257, 7, 32, "Input", "ExpressionUUID" -> \
"8d6efee4-38d8-4b0f-8617-7302ed8691b1"],
Cell[2337, 78, 214, 5, 36, "Output", "ExpressionUUID" -> \
"3a18ed84-d833-4b90-8592-238b617cde05"]
}, Open  ]],
Cell[2566, 86, 314, 6, 47, "Item", "ExpressionUUID" -> \
"84a7ae8d-9b25-4c72-8e49-a1b2d734271e"],
Cell[CellGroupData[{
Cell[2905, 96, 276, 8, 32, "Input", "ExpressionUUID" -> \
"2003a662-66b9-4130-bf2b-c77df6deb1d3"],
Cell[3184, 106, 440, 12, 58, "Output", "ExpressionUUID" -> \
"32479f24-dfbb-4065-936e-b6aafc06ed9a"]
}, Open  ]],
Cell[3639, 121, 217, 6, 30, "Item", "ExpressionUUID" -> \
"920bd736-2ded-4c4c-9a43-adfe5d82eb38"],
Cell[CellGroupData[{
Cell[3881, 131, 320, 8, 32, "Input", "ExpressionUUID" -> \
"63ff7753-665c-4382-ac23-0fc0f3de761f"],
Cell[4204, 141, 160, 3, 34, "Output", "ExpressionUUID" -> \
"3a140f09-3b1f-4e2e-b3f0-95079e73b46c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4401, 149, 340, 9, 32, "Input", "ExpressionUUID" -> \
"4b7e9ab4-9720-44bb-a1f5-10324461303b"],
Cell[4744, 160, 395, 11, 58, "Output", "ExpressionUUID" -> \
"156ed51a-1853-401e-8e39-fff495be5c25"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5176, 176, 338, 9, 32, "Input", "ExpressionUUID" -> \
"96564734-57d1-4e2d-a634-cbcc7fb7ec54"],
Cell[5517, 187, 390, 11, 58, "Output", "ExpressionUUID" -> \
"11f040fa-e183-4a90-9bf4-43a1d011c557"]
}, Open  ]],
Cell[5922, 201, 636, 17, 70, "Text", "ExpressionUUID" -> \
"0750491d-f143-401a-b001-0de3c25d08ac"],
Cell[CellGroupData[{
Cell[6583, 222, 165, 3, 32, "Input", "ExpressionUUID" -> \
"95dae21b-4f3a-401c-9acc-706537bae14d"],
Cell[6751, 227, 191, 5, 32, "Output", "ExpressionUUID" -> \
"88801a6f-d855-4e81-8934-283befe0e698"]
}, Open  ]],
Cell[6957, 235, 202, 3, 49, "Text", "ExpressionUUID" -> \
"474ac446-dad6-4763-aa90-f96024edde57"],
Cell[CellGroupData[{
Cell[7184, 242, 377, 10, 54, "Input", "ExpressionUUID" -> \
"4adc409f-fe4e-4ca7-bba7-3f5f8417ed9b"],
Cell[7564, 254, 333, 10, 50, "Output", "ExpressionUUID" -> \
"87831d2c-98f2-4774-a4eb-6de87c61db64"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7934, 269, 380, 10, 54, "Input", "ExpressionUUID" -> \
"bd37416b-22c6-4037-9533-3942b39cfde5"],
Cell[8317, 281, 339, 10, 50, "Output", "ExpressionUUID" -> \
"700125d5-4583-4f5c-a3ae-66eb3cc91eef"]
}, Open  ]]
}
]
*)

